## What happens when you search google?
What happens when you search google은 HTTP에 대해 공부했다면 한번쯤 들어봤을수도 있는 유명한 키워드 이다.   
브라우저에 "google.com" URL을 입력후 엔터를 눌렀을때 발생하는 일에 대한 키워드로 클라이언트와 서버 사이 통신 과정을 전반적으로 이해하는데 큰 도움이 된다.     
     
다음은 내가 이해한 내용을 바탕으로 작성한 글로, 내용이 다소 부족하거나 잘못되어 있을수 있다

#### What  happens when you search google
#### 1. 사용자가 https://google.com 을 검색한다.

#### 2. 브라우저는 google.com도메인에 매핑되어있는 아이피 주소를 찾는다.

google.com은 도메인 네임으로, 그 자체가 서버를 가리키고 있는것이 아닌, 서버의 아이피와 매핑됨으로써 서버를 가리킨다.
예를들어, 구글이 777.666.555.444 아이피주소를 갖고있다고 하면, google.com은 해당 아이피 주소를 대변하는 주소이다.     
브라우저는클라이언트가 입력한 도메인에 해당하는 IP를 찾기위해 로컬 캐시와 DNS를 검색한다.   
(이때, DNS에서 찾는데는 비용이 많이 나가므로 우선, 로컬 캐시에서 도메인에 해당하는 IP를 검색한다)

- 브라우저의 로컬 cache를 찾아본다. 

- OS의 로컬 cache를 찾아본다.

- 위 에서 해당하는 IP주소를 찾는데 실패했다면, DNS서버에서 IP를 검색한다.

#### 4. IP주소를 찾는데 성공했다면, 클라이언트는 서버와 통신을 시작한다.

- 구글을 검색하면 https프로토콜을 이용해 연결되므로 https프로토콜을 기준으로 설명하겠다.

- 클라이언트는 서버에 연결을 요청하며, 자신이 사용가능한 암호화 알고리즘을 함께 보낸다.

- 서버는 클라이언트에게 선택된 암호화 알고리즘, 인증서, 공개키를 함께 보낸다.
이때, 공개키로 메시지를 인코딩하며, 디코딩은 서버가 갖고있은 개인키로만 할 수 있다.

- 클라이언트는 서버를 통해 공개키를 얻고, 비밀정보를 암호화해서 서버에 전송한다. 
이때, 클라이언트는 통신하는 서버가 올바른 서버인지 인증서를 통해 확인한다.

- 서버는 전송을 보낸 클라이언트가 올바른지 확인한다.

- 서버와 클라이언트는 비밀정보를 갖고 서로의 대칭키를 만들며, 이 후 부터는 대칭키를 이용해 통신한다.

#### 5. 브라우저는 서버에 HTTP요청을 보낸다.
``` HTTP/1.1
GET https://google.com
Accept : text/html, image/svg+xml ...
Connection : keep-alive
Host : google.com
Cookie : key=value; key2=value2; ...
```

#### 6. 서버는 브라우저에 HTTP 응답을 한다.
``` HTTP
HTTP/1.1 OK 
Cache-Control : private, no-store, no-cache
Content-type : text/html; charset=UTF-8
Content-length : ...

...
```
#### 7. 브라우저는 서버의 응답을 받아, 적절한 동작을 수행한다.(화면을 그리는 등..)
